{"version":3,"sources":["webpack:///src/app/pages/session-assignment-chat/session-assignment-chat.page.html","webpack:///src/app/pages/session-assignment-chat/session-assignment-chat.page.scss","webpack:///src/app/pages/session-assignment-chat/session-assignment-chat.page.ts","webpack:///src/app/services/chat.service.ts"],"names":["SessionAssignmentChatPage","globalService","nativeHttp","storage","assignmentsService","activatedRoute","formBuilder","modalController","networkService","chatService","createchatForm","group","recipientname","chattext","required","currentRecipient","token","getselectedtoken","studentid","getselectedStudentId","sessionstatusended","SESSION_STATUS_ENDED","APIRetrieveChatInAssignment","CallAPIListOfRecipient","sessionstatus","getselectedsessionstatus","setTimeout","content","scrollToBottom","dismiss","selectrecipient","online","presentNetworkMsg","valid","APISendChatInAssignment","asgmid","getselectedasgmtid","setDataSerializer","post","apiUrl","then","response","data","JSON","parse","set","console","log","get","val","chatIRecived","e","error","presentError","status","setInterval","presentErrorchat","listRecipient","noofparticipant","length","selector","template","ChatService","toastCtrl","alertController","loadingController","text","create","header","duration","position","buttons","role","cssClass","toast","present","providedIn"],"mappings":"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","file":"default~pages-session-assignment-chat-session-assignment-chat-module~pages-session-assignment-view-s~7063bba7-es5.js","sourcesContent":["export default \"<ion-header *ngIf=\\\"this.sessionstatus!==this.sessionstatusended\\\" style=\\\"padding:3%;background-color:#274c9c;\\\">\\r\\n  <ion-title style=\\\"text-align: center;color:white;display:inline-flexbox;\\\" ><b>Instant Messaging</b><img (click)=\\\"DismissModal()\\\" style=\\\"width: 1.2em;position:absolute;right:0;\\\" src=\\\"assets/images/criss-cross_grayblue.png\\\"></ion-title>\\r\\n  </ion-header>\\r\\n  <!--Read-->\\r\\n  <ion-header *ngIf=\\\"this.sessionstatus===this.sessionstatusended\\\" style=\\\"padding:3%;background-color:#b2b2b2;\\\">\\r\\n    <ion-title style=\\\"text-align: center;color:#808080;display:inline-flexbox;\\\" ><b>Instant Messaging</b><img (click)=\\\"DismissModal()\\\" style=\\\"width: 1.2em;position:absolute;right:0;\\\" src=\\\"assets/images/criss-cross_grayblue.png\\\"></ion-title>\\r\\n    </ion-header>\\r\\n<ion-content #content overflow-scroll=\\\"true\\\">\\r\\n<div class=\\\"thirdcontent\\\" *ngFor=\\\"let chat of chatIRecived\\\">\\r\\n<ion-row >\\r\\n  <ion-col *ngIf=\\\"chat.sender_Id!=this.studentid\\\" size=\\\"9\\\"  class=\\\"message other-message\\\">\\r\\n    <b>{{chat.sender_Username}} to {{chat.recipient_Username}}:</b><br>\\r\\n    <span>{{chat.chat_Value}}</span>\\r\\n    <div class=\\\"time\\\" text-right><br>\\r\\n      <ion-label> {{chat.created_On| date:'medium'}}</ion-label>\\r\\n    </div>\\r\\n  </ion-col>\\r\\n  </ion-row>\\r\\n  <ion-row>\\r\\n    <ion-col offset=\\\"3\\\" *ngIf=\\\"chat.sender_Id==this.studentid\\\"  size=\\\"9\\\" class=\\\"message my-message\\\">\\r\\n      <b>{{chat.sender_Username}} to {{chat.recipient_Username}}:</b><br>\\r\\n      <span>{{chat.chat_Value}}</span>\\r\\n      <div class=\\\"time\\\" text-right><br>\\r\\n        <ion-label> {{chat.created_On| date:'medium'}}</ion-label>\\r\\n        <!-- <ion-datetime value=\\\"{{chat.created_On}}\\\" displayFormat=\\\"D MMM YYYY, H:mm\\\" display-timezone=\\\"utc\\\"></ion-datetime>    -->\\r\\n      </div>\\r\\n    </ion-col>\\r\\n    </ion-row>\\r\\n    \\r\\n    \\r\\n</div>\\r\\n</ion-content>\\r\\n<!--No Read-->\\r\\n<ion-footer>\\r\\n<ion-toolbar >\\r\\n  <form [formGroup]=\\\"createchatForm\\\" *ngIf=\\\"this.sessionstatus!==this.sessionstatusended\\\">\\r\\n<ion-row>  \\r\\n  <ion-col size=\\\"2\\\" class=\\\"ion-align-self-center\\\">\\r\\n  <ion-text>To:</ion-text>\\r\\n  </ion-col>\\r\\n      <ion-col offset=\\\"-1\\\" size=\\\"5\\\">\\r\\n      <ion-select [(ngModel)]=\\\"recipientname\\\"  formControlName=\\\"recipientname\\\" style=\\\"background-color: #808080;color:black;\\\" #mySelect  (ionChange)=\\\"selectChanged(mySelect.value)\\\">\\r\\n        <ion-select-option><label>Everyone</label></ion-select-option>\\r\\n        <div *ngFor=\\\"let recipient of listRecipient\\\">\\r\\n        <ion-select-option value=\\\"{{recipient.user_Id}}\\\" *ngIf=\\\"recipient.user_Id!=this.studentid&&this.noofparticipant!=1\\\"><label>{{ recipient.user_Username }}</label></ion-select-option>\\r\\n      </div>\\r\\n      </ion-select>\\r\\n    </ion-col>\\r\\n  <ion-col size=\\\"10\\\">\\r\\n  <textarea formControlName=\\\"chattext\\\" autosize maxRows=\\\"4\\\"  [(ngModel)]=\\\"chattext\\\" class=\\\"message-input\\\"></textarea>\\r\\n  </ion-col>\\r\\n  <ion-col size=\\\"2\\\" class=\\\"ion-align-self-center\\\">\\r\\n    <img style=\\\"width:2em;\\\" src=\\\"assets/images/user-interface.png\\\" (click)=\\\"SendMessage()\\\"><br/>\\r\\n  </ion-col>\\r\\n</ion-row>\\r\\n</form>\\r\\n</ion-toolbar>\\r\\n</ion-footer>\\r\\n\\r\\n\\r\\n\";","export default \".message {\\n  padding: 1em;\\n  border-radius: 1em;\\n  margin-bottom: 1em;\\n  white-space: pre-wrap;\\n}\\n\\n.other-message {\\n  background: #f0f0a7;\\n  color: #000000;\\n}\\n\\n.my-message {\\n  background: #d9f6ff;\\n  color: #000000;\\n}\\n\\n.time {\\n  color: #808080;\\n  float: right;\\n  font-size: small;\\n}\\n\\n.message-input {\\n  width: 100%;\\n  border: 0.1em solid var(--ion-color-medium);\\n  border-radius: 1em;\\n  resize: none;\\n  padding-left: 1em;\\n  padding-right: 1em;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvc2Vzc2lvbi1hc3NpZ25tZW50LWNoYXQvQzpcXFVzZXJzXFxEYW5hZVxcRGVza3RvcFxcRllQSlxcSW9uaWNGUC9zcmNcXGFwcFxccGFnZXNcXHNlc3Npb24tYXNzaWdubWVudC1jaGF0XFxzZXNzaW9uLWFzc2lnbm1lbnQtY2hhdC5wYWdlLnNjc3MiLCJzcmMvYXBwL3BhZ2VzL3Nlc3Npb24tYXNzaWdubWVudC1jaGF0L3Nlc3Npb24tYXNzaWdubWVudC1jaGF0LnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLFlBQUE7RUFDQSxrQkFBQTtFQUNBLGtCQUFBO0VBQ0EscUJBQUE7QUNDRjs7QURFQTtFQUNDLG1CQUFBO0VBQ0EsY0FBQTtBQ0NEOztBREVBO0VBQ0UsbUJBQUE7RUFDQSxjQUFBO0FDQ0Y7O0FERUE7RUFDQyxjQUFBO0VBQ0EsWUFBQTtFQUNBLGdCQUFBO0FDQ0Q7O0FERUE7RUFDRSxXQUFBO0VBQ0EsMkNBQUE7RUFDQSxrQkFBQTtFQUNBLFlBQUE7RUFDQSxpQkFBQTtFQUNBLGtCQUFBO0FDQ0YiLCJmaWxlIjoic3JjL2FwcC9wYWdlcy9zZXNzaW9uLWFzc2lnbm1lbnQtY2hhdC9zZXNzaW9uLWFzc2lnbm1lbnQtY2hhdC5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIubWVzc2FnZSB7XHJcbiAgcGFkZGluZzogMWVtO1xyXG4gIGJvcmRlci1yYWRpdXM6IDFlbTtcclxuICBtYXJnaW4tYm90dG9tOiAxZW07XHJcbiAgd2hpdGUtc3BhY2U6IHByZS13cmFwO1xyXG59XHJcblxyXG4ub3RoZXItbWVzc2FnZSB7XHJcbiBiYWNrZ3JvdW5kOiAjZjBmMGE3O1xyXG4gY29sb3I6ICMwMDAwMDA7XHJcbn1cclxuXHJcbi5teS1tZXNzYWdlIHtcclxuICBiYWNrZ3JvdW5kOiAjZDlmNmZmO1xyXG4gIGNvbG9yOiAjMDAwMDAwO1xyXG59XHJcblxyXG4udGltZSB7XHJcbiBjb2xvcjogIzgwODA4MDtcclxuIGZsb2F0OiByaWdodDtcclxuIGZvbnQtc2l6ZTogc21hbGw7XHJcbn1cclxuXHJcbi5tZXNzYWdlLWlucHV0IHtcclxuICB3aWR0aDogMTAwJTtcclxuICBib3JkZXI6IDAuMWVtIHNvbGlkIHZhcigtLWlvbi1jb2xvci1tZWRpdW0pO1xyXG4gIGJvcmRlci1yYWRpdXM6IDFlbTtcclxuICByZXNpemU6IG5vbmU7XHJcbiAgcGFkZGluZy1sZWZ0OiAxZW07XHJcbiAgcGFkZGluZy1yaWdodDogMWVtO1xyXG59IiwiLm1lc3NhZ2Uge1xuICBwYWRkaW5nOiAxZW07XG4gIGJvcmRlci1yYWRpdXM6IDFlbTtcbiAgbWFyZ2luLWJvdHRvbTogMWVtO1xuICB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7XG59XG5cbi5vdGhlci1tZXNzYWdlIHtcbiAgYmFja2dyb3VuZDogI2YwZjBhNztcbiAgY29sb3I6ICMwMDAwMDA7XG59XG5cbi5teS1tZXNzYWdlIHtcbiAgYmFja2dyb3VuZDogI2Q5ZjZmZjtcbiAgY29sb3I6ICMwMDAwMDA7XG59XG5cbi50aW1lIHtcbiAgY29sb3I6ICM4MDgwODA7XG4gIGZsb2F0OiByaWdodDtcbiAgZm9udC1zaXplOiBzbWFsbDtcbn1cblxuLm1lc3NhZ2UtaW5wdXQge1xuICB3aWR0aDogMTAwJTtcbiAgYm9yZGVyOiAwLjFlbSBzb2xpZCB2YXIoLS1pb24tY29sb3ItbWVkaXVtKTtcbiAgYm9yZGVyLXJhZGl1czogMWVtO1xuICByZXNpemU6IG5vbmU7XG4gIHBhZGRpbmctbGVmdDogMWVtO1xuICBwYWRkaW5nLXJpZ2h0OiAxZW07XG59Il19 */\";","import { Component,ViewChild,OnInit } from '@angular/core';\r\nimport { ModalController } from '@ionic/angular';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport {NetworkService} from '../../services/network.service';\r\nimport {ChatService} from '../../services/chat.service';\r\nimport { HTTP } from '@ionic-native/http/ngx';\r\nimport { AssignmentsService } from '../../services/assignments.service';\r\nimport {SessionStatus,apiurl} from '../../model/global-api';\r\nimport { Storage } from '@ionic/storage';\r\nimport {  GlobalService} from '../../services/global.service';\r\n@Component({\r\n  selector: 'app-session-assignment-chat',\r\n  templateUrl: './session-assignment-chat.page.html',\r\n  styleUrls: ['./session-assignment-chat.page.scss'],\r\n})\r\nexport class SessionAssignmentChatPage implements OnInit {\r\n  constructor(private globalService: GlobalService,private nativeHttp:HTTP,private storage:Storage,private assignmentsService: AssignmentsService,private activatedRoute: ActivatedRoute, public formBuilder: FormBuilder, private modalController:ModalController,private networkService:NetworkService,private chatService:ChatService) {\r\n    this.createchatForm = formBuilder.group({\r\n      recipientname: [''],\r\n      chattext: ['', Validators.required]\r\n  });\r\n  }\r\n  \r\n  @ViewChild('content') content: any;\r\n  public recipients: Array<string>;\r\n  public currentRecipient: string;\r\n sessionstatus:any;sessionstatusended:any;asgmid:any;chatIRecived:any;\r\n //Form \r\n public createchatForm: FormGroup;recipientname:any;chattext:any;listRecipient:any;noofparticipant:any;\r\n\r\n //User Info\r\n token:any;studentid:any;\r\n  ngOnInit(){\r\n    this.currentRecipient = \"Everyone\";\r\n    this.recipientname=\"Everyone\";\r\n  }\r\n  ionViewWillEnter(): void {\r\n    this.token=this.globalService.getselectedtoken() //Get Token\r\n    this.studentid=this.globalService.getselectedStudentId()//Get Tutor\r\n    this.sessionstatusended=SessionStatus.SESSION_STATUS_ENDED;\r\n    this.APIRetrieveChatInAssignment();//Retrive Chats\r\n    this.CallAPIListOfRecipient();//Receive Participant in Session\r\n    this.sessionstatus=this.assignmentsService.getselectedsessionstatus();//Get Session Status\r\n   setTimeout(() => {\r\n      this.content.scrollToBottom(300);\r\n  }, 2000);\r\n  \r\n}\r\n    //Close Chat\r\n    DismissModal(){\r\n      this.modalController.dismiss();\r\n    }\r\n    //Change of selected recipient\r\n    selectChanged(selectrecipient) {\r\n      this.currentRecipient = selectrecipient;\r\n      this.recipientname = selectrecipient;\r\n     // console.log(this.recipientname)\r\n     }\r\n    SendMessage(){\r\n      if(this.networkService.online == false )\r\n      {\r\n        this.networkService.presentNetworkMsg(); \r\n      }\r\n      else{\r\n      if(this.createchatForm.valid)\r\n      {\r\n        //POST METHOD\r\n       // console.log(this.recipientname)\r\n       // console.log(this.chattext)\r\n        this.APISendChatInAssignment() //Send Message\r\n         this.chattext=\"\";\r\n      }\r\n      }\r\n    }\r\n    /*POST METHOD*/\r\n APIRetrieveChatInAssignment()\r\n {\r\n   this.asgmid=this.assignmentsService.getselectedasgmtid()\r\n  this.nativeHttp.setDataSerializer('json');\r\n   this.nativeHttp.post(apiurl.apiUrl+'chat/retrieve', {\r\n    \"Authentication_Token\":this.token, //Get from storage \r\n   \"Asgmt_Id\":this.asgmid,\r\n   \"User_Id\": this.studentid,//Get from storage \r\n}, {\r\n  'Accept': 'application/json',\r\n  'Content-Type': 'application/json' })\r\n  .then(response => {\r\n    try {\r\n      response.data = JSON.parse(response.data);\r\n      this.storage.set('chatdetails', response.data); \r\n      console.log(response.data)\r\n      this.storage.get('chatdetails').then((val) => {\r\n        this.chatIRecived=val;\r\n        });\r\n    } catch(e) {\r\n      console.error(e);\r\n      this.modalController.dismiss();\r\n      this.assignmentsService.presentError()\r\n    }\r\n })\r\n .catch(response => {\r\n   // prints 403\r\n  console.log(response.status);\r\n\r\n   // prints Permission denied\r\n  console.log(response.error);\r\n  this.modalController.dismiss();\r\n  this.assignmentsService.presentError()\r\n\r\n });\r\n }\r\n   /*POST METHOD*/\r\n   APISendChatInAssignment()\r\n   {\r\n     this.asgmid=this.assignmentsService.getselectedasgmtid()//Get Assignment Id\r\n    this.nativeHttp.setDataSerializer('json');\r\n     this.nativeHttp.post(apiurl.apiUrl+'chat/send', {\r\n    \"Authentication_Token\":this.token, //Get from storage \r\n     \"Asgmt_Id\":this.asgmid,\r\n     \"Sender\":this.studentid,\r\n     \"Recipient\":this.recipientname,\r\n     \"Chat_Value\":this.chattext\r\n  }, {\r\n    'Accept': 'application/json',\r\n    'Content-Type': 'application/json' })\r\n    .then(response => {\r\n      try {\r\n       response.data = JSON.parse(response.data);\r\n       // this.APIRetrieveChatInAssignment();\r\n        setInterval(() => { \r\n          this.APIRetrieveChatInAssignment(); // Now the \"this\" still references the component\r\n       }, 500);//half a second\r\n       this.content.scrollToBottom();\r\n     \r\n      } catch(e) {\r\n        console.error(e);\r\n        this.assignmentsService.presentErrorchat()\r\n      }\r\n   })\r\n   .catch(response => {\r\n     // prints 403\r\n    console.log(response.status);\r\n  \r\n     // prints Permission denied\r\n    console.log(response.error);\r\n    this.assignmentsService.presentErrorchat()\r\n   });\r\n   }\r\n  /*Call APIListRecipient METHOD*/\r\n   CallAPIListOfRecipient(){\r\n    this.asgmid=this.assignmentsService.getselectedasgmtid() //Get asgmt id\r\n    this.nativeHttp.setDataSerializer('json');\r\n    this.nativeHttp.post(apiurl.apiUrl+'chat/listRecipient', {\r\n   \"Authentication_Token\":this.token, //Get from storage \r\n    \"Asgmt_Id\":this.asgmid,\r\n    \"User_Id\": this.studentid,\r\n }, {\r\n   'Accept': 'application/json',\r\n   'Content-Type': 'application/json' })\r\n   .then(response => {\r\n     try {\r\n       response.data = JSON.parse(response.data);\r\n       //console.log(response.data)\r\n       this.listRecipient=response.data;\r\n       this.noofparticipant=this.listRecipient.length;\r\n     } catch(e) {\r\n       console.error(e);\r\n       this.modalController.dismiss();\r\n       this.assignmentsService.presentError()\r\n     }\r\n  })\r\n  .catch(response => {\r\n    // prints 403\r\n   console.log(response.status);\r\n \r\n    // prints Permission denied\r\n   console.log(response.error);\r\n   this.modalController.dismiss();\r\n   this.assignmentsService.presentError() \r\n   });\r\n   }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport {ToastController,AlertController,LoadingController } from '@ionic/angular';\r\nimport { HTTP } from '@ionic-native/http/ngx';\r\nimport { Storage } from '@ionic/storage';\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ChatService {\r\n\r\nconstructor(private nativeHttp:HTTP,private toastCtrl: ToastController,private alertController:AlertController,public loadingController: LoadingController,private storage:Storage) {}\r\n\r\n public data:any;\r\n  //Pop-up message\r\nasync presentToastWithOptions(text) {\r\n  const toast = await this.toastCtrl.create({\r\n    header: text,\r\n    duration: 3000,\r\n    position: 'bottom',\r\n    buttons: [{\r\n      text: 'CLOSE',\r\n      role: 'cancel'\r\n    }],\r\n    cssClass: 'toastCSS'\r\n  });\r\n  toast.present();\r\n}\r\n\r\n\r\n}\r\n"]}